<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Nido LOC History</title>
<style>
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:24px; color:#111; }
  h1 { margin:0 0 12px; font-size:20px; }
  .wrap { max-width:1100px; }
  #chart { width:100%; height:520px; }
  .meta { margin:8px 0 16px; color:#444; font-size:12px; }
  button { padding:6px 10px; border:1px solid #ddd; background:#f8f8f8; cursor:pointer; border-radius:6px; }
  button:hover { background:#eee; }
</style>
</head>
<body>
<div class="wrap">
  <h1>LOC History</h1>
  <div class="meta">Source: metrics/loc_history.csv · Toggle series via legend. Click “Download PNG” to export.</div>
  <canvas id="chart"></canvas>
  <div style="margin-top:10px;">
    <button id="dl">Download PNG</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3"></script>
<script>
const labels = ["2025-08-29 14:11:35","2025-08-29 14:11:43","2025-08-29 14:15:41"];
const kotlin = [8539,8539,8539];
const xml     = [425,425,425];
const total   = [8964,8964,8964];

const ctx = document.getElementById('chart').getContext('2d');
const chart = new Chart(ctx, {
  type: 'line',
  data: {
    labels,
    datasets: [
      { label: 'Total LOC',  data: total,  tension: 0.2, borderWidth: 2, pointRadius: 2 },
      { label: 'Kotlin LOC', data: kotlin, tension: 0.2, borderWidth: 2, pointRadius: 2 },
      { label: 'XML LOC',    data: xml,    tension: 0.2, borderWidth: 2, pointRadius: 2 },
    ]
  },
  options: {
    responsive: true,
    interaction: { mode: 'nearest', intersect: false },
    plugins: { legend: { position: 'top' } },
    scales: {
      x: { title: { display: true, text: 'Snapshot datetime' } },
      y: { title: { display: true, text: 'Lines of code' }, beginAtZero: true }
    }
  }
});

document.getElementById('dl').addEventListener('click', () => {
  const a = document.createElement('a');
  a.href = chart.toBase64Image();
  a.download = 'loc_history.png';
  a.click();
});
</script>
</body>
</html>
